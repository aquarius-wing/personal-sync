# CalendarSync Dashboard 故障排除指南

## 常见问题及解决方案

### 1. "Missing package product 'CalendarSync'" 错误

**问题**: Xcode显示找不到CalendarSync包产品

**解决方案**:
1. **使用自动修复脚本**（推荐）:
   ```bash
   cd /Users/wing/Develop/swift-sync-system-data/Examples/
   ./修复依赖.sh
   ```

2. **手动修复**:
   - 关闭Xcode
   - 删除缓存: `rm -rf ~/Library/Developer/Xcode/DerivedData/CalendarSyncDashboard-*`
   - 重新打开项目
   - 等待依赖解析完成

3. **在Xcode中重置包缓存**:
   - File → Swift Packages → Reset Package Caches
   - File → Swift Packages → Resolve Package Versions

### 2. 编译错误

**问题**: Swift编译错误或找不到模块

**解决方案**:
1. 检查Deployment Target设置为iOS 15.0+
2. 清理构建缓存: Product → Clean Build Folder (Cmd+Shift+K)
3. 确保CalendarSync包构建成功:
   ```bash
   cd /Users/wing/Develop/swift-sync-system-data/
   swift build
   ```

### 3. 权限相关问题

**问题**: 运行时权限错误或无法访问日历

**解决方案**:
1. 检查Info.plist包含日历权限描述
2. 在设备设置中检查权限: 设置 → 隐私与安全性 → 日历
3. 删除app重新安装以重置权限
4. 确保在真机上测试（模拟器无法访问日历）

### 4. 依赖解析失败

**问题**: Package resolution failed

**解决方案**:
1. 检查网络连接（GRDB.swift需要从GitHub下载）
2. 验证根目录Package.swift文件完整性:
   ```bash
   cd /Users/wing/Develop/swift-sync-system-data/
   swift package resolve
   ```
3. 清理并重新下载依赖:
   ```bash
   swift package clean
   swift package resolve
   ```

### 5. Xcode项目无法打开

**问题**: 双击项目文件无反应或出错

**解决方案**:
1. 确保Xcode版本支持（14.0+）
2. 重启Xcode
3. 检查文件权限:
   ```bash
   ls -la CalendarSyncDashboard.xcodeproj/
   ```
4. 使用命令行打开:
   ```bash
   open CalendarSyncDashboard.xcodeproj
   ```

### 6. 运行时崩溃

**问题**: App启动时崩溃

**解决方案**:
1. 查看Xcode控制台日志
2. 检查CalendarSync初始化错误
3. 确保设备有可访问的日历数据
4. 尝试在不同设备上测试

### 7. 界面显示异常

**问题**: UI布局错误或显示不正常

**解决方案**:
1. 检查设备iOS版本（需要15.0+）
2. 重启app
3. 检查是否有SwiftUI预览错误
4. 尝试不同屏幕尺寸的设备

## 调试技巧

### 启用详细日志
在 `CalendarSyncDashboardApp.swift` 中启用日志记录:
```swift
let config = CalendarSyncConfiguration(
    enableLogging: true,  // 启用详细日志
    // ... 其他配置
)
```

### 检查包状态
```bash
# 在项目根目录
swift package dump-package  # 查看包配置
swift package show-dependencies  # 显示依赖树
```

### Xcode调试
- 使用断点调试CalendarSync初始化过程
- 查看控制台输出的错误信息
- 使用Xcode的包管理器界面检查依赖状态

## 环境要求

### 系统要求
- macOS 12.0+
- Xcode 14.0+
- iOS 15.0+ 设备（用于运行）

### 网络要求
- 首次构建需要下载GRDB.swift依赖
- 确保网络可以访问GitHub

## 联系支持

如果以上解决方案都无效，请提供以下信息：

1. **错误截图**
2. **Xcode版本**: `xcodebuild -version`
3. **macOS版本**: `sw_vers`
4. **完整错误日志**
5. **构建日志**: Product → Show Build Timeline

## 快速重置命令

如果一切都不工作，尝试完全重置：

```bash
# 完全清理
cd /Users/wing/Develop/swift-sync-system-data/Examples/
./修复依赖.sh

# 或者手动清理所有缓存
rm -rf ~/Library/Developer/Xcode/DerivedData/
rm -rf ~/Library/Caches/org.swift.swiftpm/
rm -rf CalendarSyncDashboard.xcodeproj/project.xcworkspace/xcuserdata
rm -rf CalendarSyncDashboard.xcodeproj/xcuserdata

# 重新构建CalendarSync包
cd ..
swift package clean
swift package resolve
swift build

# 重新打开项目
cd Examples
open CalendarSyncDashboard.xcodeproj
```

---

大多数问题都可以通过运行 `./修复依赖.sh` 脚本解决！🛠️ 